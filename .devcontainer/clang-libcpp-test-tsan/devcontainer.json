// built with Clang; optimized for detecting thread bugs
{
    "name": "test Clang/libc++ TSan",
    "build": {
        "dockerfile": "${localWorkspaceFolder}/.devcontainer/Dockerfile",
        "args": {
            "base_image": "base-clang-libcpp",
            "base_image_version": "2026-02-07",
            "profile": "clang-libcpp-test-tsan"
        },
        "context": "${localWorkspaceFolder}"
    },
    "remoteUser": "root",
    "runArgs": [
        "--privileged"
    ],
    "postCreateCommand": {
        "configure build system": [
            "cmake",
            "--toolchain", "/tmp/build/conan_toolchain.cmake",
            "-B", "/tmp/build",
            "-DCMAKE_BUILD_TYPE=Debug",
            "-DCMAKE_PREFIX_PATH=/tmp/build",
            "-G", "Ninja",
            "-S", "${localEnv:PROJECT_SUBDIRECTORY:.}",
            "-DCMAKE_CXX_STDLIB_MODULES_JSON=/usr/lib/llvm-22/lib/libc++.modules.json"
        ]
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-vscode.cmake-tools",
                "ms-vscode.cpptools"
            ]
        }
    }
}
